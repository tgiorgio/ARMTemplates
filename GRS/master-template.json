{
    "$schema": "https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {},
    "variables": {
      "location":"uksouth",
      "vnetRG":"EoEUKSOUTHVNET-RG",
      "FortigateRG":"EoEUKSOUTHFG-RG"
    },
    "resources": [
      {
        "type": "Microsoft.Resources/resourceGroups",
        "apiVersion": "2018-05-01",
        "location": "[variables('location')]",
        "name": "[variables('vnetRG')]",
        "properties": {}
      },
      {
        "type": "Microsoft.Resources/deployments",
        "apiVersion": "2018-05-01",
        "name": "GRSDeployVNET",
        "resourceGroup": "[variables('vnetRG')]",
        "dependsOn": ["[resourceId('Microsoft.Resources/resourceGroups/', parameters('rgName'))]"],
        "properties": {
            "mode": "Incremental",
            "templateLink": {
                "uri":"https://github.com/tgiorgio/ARMTemplates/blob/master/GRS/GRS-VNET-template.json"
                
            },
            "parametersLink": {
                "uri":"https://mystorageaccount.blob.core.windows.net/AzureTemplates/newStorageAccount.parameters.json"
                
            }
        }
      },   
      {
        "type": "Microsoft.Resources/resourceGroups",
        "apiVersion": "2018-05-01",
        "location": "[variables('location')]",
        "name": "[variables('FortigateRG')]",
        "properties": {}
      },
      {
        "type": "Microsoft.Resources/deployments",
        "apiVersion": "2018-05-01",
        "name": "GRSDeployFortigate",
        "resourceGroup": "[variables('FortigateRG')]",
        "dependsOn": ["GRSDeployVNET",
          "[resourceId('Microsoft.Resources/resourceGroups/', variables('FortigateRG'))]"
        ],
        "properties": {
            "mode": "Incremental",
            "templateLink": {
                "uri":"https://github.com/tgiorgio/ARMTemplates/blob/master/GRS/GRS-Fortigate-Template.json"
                
            },
            "parameters": {
                "location":{
                  "value": "uksouth"
                },
                "FortiGateImageSKU" :{
                    "value" : "fortinet_fg-vm_payg"
                },
                "instanceType" :{
                    "value" : "Standard_F1"
                },
                "customerprefix":{
                  "value": "[reference('GRSDeployVNET').outputs.customerprefix.value]"
                },
                "VNetName":{
                  "value":"[reference('GRSDeployVNET').outputs.VNetName.value]"
                },
                "vnetID" :{
                  "value": "[reference('GRSDeployVNET').outputs.vnetID.value]"
                },
                "vnetAddressPrefix":{
                  "value":"[reference('GRSDeployVNET').outputs.vnetAddressPrefix.value]"
                },
                "Subnet1Prefix": {
                  "value": "[reference('GRSDeployVNET').outputs.Subnet1Prefix.value]"
                },
                "Subnet1Name": {
                  "value": "[reference('GRSDeployVNET').outputs.Subnet1Name.value]"
                },
                "Subnet2Prefix": {
                  "value": "[reference('GRSDeployVNET').outputs.Subnet2Prefix.value]"
                },
                "Subnet2Name": {
                  "value": "[reference('GRSDeployVNET').outputs.Subnet2Name.value]"
                },
                "Subnet3Prefix": {
                  "value": "[reference('GRSDeployVNET').outputs.Subnet3Prefix.value]"
                },
                "Subnet3Name": {
                  "value": "[reference('GRSDeployVNET').outputs.Subnet3Name.value]"
                },
                "Subnet4Prefix": {
                  "value": "[reference('GRSDeployVNET').outputs.Subnet4Prefix.value]"
                },
                "Subnet4Name": {
                  "value": "[reference('GRSDeployVNET').outputs.Subnet4Name.value]"
                },
                "Subnet5Prefix": {
                  "value": "[reference('GRSDeployVNET').outputs.Subnet5Prefix.value]"
                },
                "Subnet5Name": {
                  "value": "[reference('GRSDeployVNET').outputs.Subnet5Name.value]"
                },
                "Subnet6Prefix": {
                  "value": "[reference('GRSDeployVNET').outputs.Subnet6Prefix.value]"
                },
                "Subnet6Name": {
                  "value": "[reference('GRSDeployVNET').outputs.Subnet6Name.value]"
                },
                "Subnet7Prefix": {
                  "value": "[reference('GRSDeployVNET').outputs.Subnet7Prefix.value]"
                },
                "Subnet7Name": {
                  "value": "[reference('GRSDeployVNET').outputs.Subnet7Name.value]"
                },
                "Subnet8Prefix": {
                  "value": "[reference('GRSDeployVNET').outputs.Subnet8Prefix.value]"
                },
                "Subnet8Name": {
                  "value": "[reference('GRSDeployVNET').outputs.Subnet8Name.value]"
                },
                "Subnet9Prefix": {
                  "value": "[reference('GRSDeployVNET').outputs.Subnet9Prefix.value]"
                },
                "Subnet9Name": {
                  "value": "[reference('GRSDeployVNET').outputs.Subnet9Name.value]"
                }
                
                
            }
        }
      }
    ],
    "outputs": {
        "vnetID":{
            "type": "string",
            "value": "[reference('GRSDeployVNET').outputs.vnetID.value]"
        }
    }
}